package com.example.demoio.wold;

import cn.hutool.core.codec.Base64Decoder;
import com.deepoove.poi.XWPFTemplate;
import com.deepoove.poi.data.MiniTableRenderData;
import com.deepoove.poi.data.PictureRenderData;
import com.deepoove.poi.data.RowRenderData;
import com.deepoove.poi.data.TextRenderData;
import io.swagger.annotations.Api;
import lombok.AllArgsConstructor;
import org.springframework.core.io.ClassPathResource;
import org.springframework.core.io.Resource;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import javax.servlet.ServletOutputStream;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.io.InputStream;
import java.net.URLEncoder;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

/**
 * 导出word
 * 参考文档：http://deepoove.com/poi-tl/#_%E8%A1%A8%E6%A0%BC%E6%A8%A1%E6%9D%BFvar
 */
@Api(value = "/word", tags = "导出word")
@RestController
@AllArgsConstructor
@RequestMapping("/word")
public class ExportWordController {

	private static String TEMPLATE = "template/template.docx";

	/**
	 * 导出wold测试
	 *
	 * @param response
	 */
	@RequestMapping("/exportWord")
	public void exportWord(HttpServletResponse response) {
		try {
			String fileName = "导出wold测试.doc";
			InputStream inputStream = getInputStream(TEMPLATE);
			XWPFTemplate template = XWPFTemplate.compile(inputStream);
 			// 字符串：{{str}}
			String str = "字符串";
			HashMap<String, Object> map = new HashMap<>();
			map.put("str", str);

			// 图片：{@image}}
			String imgIO = "data:image/png;base64,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";
			String imagesBase64 = imgIO.replace("data:image/png;base64,", "");
			byte[] bytes1 = Base64Decoder.decode(imagesBase64);
			map.put("image", new PictureRenderData(620, 320, ".png", bytes1));

			// 表格：{{#table}}
			//序号	姓名	电话	性别	年龄
			RowRenderData header = RowRenderData.build(
					new TextRenderData("", "序号"),
					new TextRenderData("", "姓名"),
					new TextRenderData("", "电话"),
					new TextRenderData("", "性别"),
					new TextRenderData("", "年龄"));
			List<RowRenderData> rowRenderData = new ArrayList<>();
			rowRenderData.add(RowRenderData.build("1","王五","150101515115", "男", "29"));
			map.put("table", new MiniTableRenderData(header, rowRenderData));

			template.render(map);
			response.setCharacterEncoding("utf-8");
			response.setContentType("application/msword");
			// 设置浏览器以下载的方式处理该文件名
			fileName = new String(fileName.getBytes("UTF-8"), "ISO8859-1");// 谷歌
			response.setHeader("Content-Disposition", "attachment;filename=".concat(String.valueOf(URLEncoder.encode(fileName, "iso-8859-1"))));
			ServletOutputStream out = response.getOutputStream();
			template.write(response.getOutputStream());
			out.flush();
			out.close();
			template.close();
		} catch (IOException e) {
			e.printStackTrace();
		}

	}

	/**
	 * 根据路径，查找resources下的文件，返回字节流
	 *
	 * @param path
	 * @return
	 * @throws IOException
	 */
	public InputStream getInputStream(String path) throws IOException {
		InputStream inputStream = null;
		Resource resource = new ClassPathResource(path);
		String fileName = resource.getFilename();
		System.out.println(fileName);
		if (resource.isReadable()) {
			//每次都会打开一个新的流
			inputStream = resource.getInputStream();
		}
		return inputStream;
	}
}